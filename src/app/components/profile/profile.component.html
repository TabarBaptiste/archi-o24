<div class="profile-container">
    <h2>Mon profil</h2>

    <div class="profile-card" *ngIf="profile && !loading">
        <p><strong>Nom :</strong> {{ profile.name }}</p>
        <p><strong>Email :</strong> {{ profile.email }}</p>
        <p *ngIf="profile.createdAt"><strong>Inscrit depuis :</strong> {{ profile.createdAt | date:'longDate' }}</p>
    </div>

    <div class="profile-actions" *ngIf="profile && !loading">
        <button class="edit-btn" (click)="editProfile()">
            ✏️ Modifier le profil
        </button>
        
        <button class="refresh-btn" (click)="refreshProfile()" [disabled]="loading">
            🔄 Rafraîchir
        </button>
        
        <button class="delete-btn" (click)="confirmDeleteAccount()">
            🗑️ Supprimer le compte
        </button>
        
        <button class="logout-btn" (click)="logout()">
            🚪 Se déconnecter
        </button>
    </div>

    <!-- Modal de confirmation de suppression -->
    <div class="delete-confirmation" *ngIf="showDeleteConfirmation">
        <div class="confirmation-backdrop" (click)="cancelDeleteAccount()"></div>
        <div class="confirmation-modal">
            <h3>⚠️ Confirmer la suppression</h3>
            <p>Êtes-vous sûr de vouloir supprimer définitivement votre compte ?</p>
            <p class="warning-text">Cette action est irréversible !</p>
            
            <div class="confirmation-actions">
                <button class="cancel-btn" (click)="cancelDeleteAccount()">
                    Annuler
                </button>
                <button class="confirm-delete-btn" (click)="deleteAccount()" [disabled]="loading">
                    {{ loading ? 'Suppression...' : 'Oui, supprimer' }}
                </button>
            </div>
        </div>
    </div>

    <!-- Modal d'édition du profil -->
    <div class="edit-modal" *ngIf="showEditModal">
        <div class="modal-backdrop" (click)="closeEditModal()"></div>
        <div class="modal-content">
            <app-profile-edit (close)="closeEditModal()"></app-profile-edit>
        </div>
    </div>

    <div *ngIf="loading" class="loading">
        <p>Chargement du profil...</p>
    </div>
    
    <div *ngIf="error && !loading" class="error">
        <p>{{ error }}</p>
        <button *ngIf="error.includes('connecté')" (click)="logout()" class="login-btn">
            Se connecter
        </button>
    </div>
</div>